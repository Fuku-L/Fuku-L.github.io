

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fishes.png">
  <link rel="icon" href="/img/fishes.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Fuku Lee">
  <meta name="keywords" content="">
  
  <title>Fuku</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/diy/shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.10","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":true},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>F's Log</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20210427005926.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-10-12 11:28" pubdate>
        2022年10月12日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.1k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      22
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none"></h1>
            
            <div class="markdown-body">
              <h2 id="MySQL-读写分离"><a href="#MySQL-读写分离" class="headerlink" title="MySQL 读写分离"></a>MySQL 读写分离</h2><h3 id="MySQL-读写分离的两种架构："><a href="#MySQL-读写分离的两种架构：" class="headerlink" title="MySQL 读写分离的两种架构："></a>MySQL 读写分离的两种架构：</h3><ul>
<li>客户端直连：客户端 client 主动做负载均衡，将数据库连接信息放在客户端连接层，由客户端来选择后端数据库进行查询</li>
<li>带 proxy：在 MySQL 和客户端 client 之间有一个中间代理层 proxy。客户端只连 proxy，由 proxy 根据请求类型和上下文决定请求的分发路由。</li>
</ul>
<p><img src="https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20220310142600.png" srcset="/img/loading.gif" lazyload alt="图1 带proxy的读写分离架构"></p>
<h4 id="两种架构对比："><a href="#两种架构对比：" class="headerlink" title="两种架构对比："></a>两种架构对比：</h4><ol>
<li>客户端直连，少了proxy转发，查询性能稍微好点 ；整体架构简单，排查问题方便；需要了解后端部署细节，并且在主备切换、库迁移操作时，需要调整数据库连接信息，同时客户端会有感知。一般伴随一个负责后端的组件（zookeeper），让业务端只专注于业务逻辑的开发。</li>
<li>带 proxy 的架构，对客户端友好，客户端不需要关注后端细节，连接维护、后端信息维护等工作，都由 proxy 完成。proxy需要高可用架构，整体架构复杂，对后端维护团队要求更高，需要很了解才能排查问题。</li>
</ol>
<h4 id="无论哪种读写分离架构，都存在“过期读”的问题。"><a href="#无论哪种读写分离架构，都存在“过期读”的问题。" class="headerlink" title="无论哪种读写分离架构，都存在“过期读”的问题。"></a>无论哪种读写分离架构，都存在“过期读”的问题。</h4><blockquote>
<p>过期读发生在，用户更新完数据之后立刻发起查询，由于存在主备延迟导致从库还未更新，用户查询时选择该从库就会导致过期读现象。</p>
</blockquote>
<h3 id="过期读的处理方案："><a href="#过期读的处理方案：" class="headerlink" title="过期读的处理方案："></a>过期读的处理方案：</h3><ol>
<li>强制走主库；</li>
<li>sleep 方案；</li>
<li>判断主备无延迟；</li>
<li>配合 semi-sync</li>
<li>等主库位点</li>
<li>等 GTID</li>
</ol>
<h4 id="强制走主库"><a href="#强制走主库" class="headerlink" title="强制走主库"></a>强制走主库</h4><ul>
<li>对查询请求做分类。通常情况下，查询请求可以分为两类：<ol>
<li>必须拿到最新结果的请求，则必须走主库。</li>
<li>可以读到旧数据的请求，才将其发到从库上。</li>
</ol>
</li>
</ul>
<h4 id="Sleep-1"><a href="#Sleep-1" class="headerlink" title="Sleep(1)"></a>Sleep(1)</h4><ul>
<li><p>在对从库发起查询之前，先执行 sleep(1)。</p>
<p>以商家发布商品为例，商品发布后，用 Ajax 直接把客户输入的内容作为“新商品”显示在页面上，让卖家确认商品已经发布成功了，等商家再刷新页面时候已经超过1s，也就达到了 sleep 的目的。</p>
</li>
<li><p>严格意义上， sleep(1) 方案不精确：</p>
<ol>
<li> 请求只要 0.5 s就可以查到结果，但要等 1 s</li>
<li>如果主备延迟超过 1 s ，仍有过期读问题。</li>
</ol>
</li>
</ul>
<h4 id="备库直接判断主备无延迟"><a href="#备库直接判断主备无延迟" class="headerlink" title="备库直接判断主备无延迟"></a>备库直接判断主备无延迟</h4><p>有三种方案可以确保主备无延迟。</p>
<ol>
<li><p>通过 <code>show slave status</code> 结果中的 <code>seconds_behind_master</code> 参数的值来衡量。判断 <code>seconds_behind_master == 0</code>，等于0才执行查询请求。<strong>该方法单位为秒</strong>。</p>
</li>
<li><p>采用对比位点，通过 <code>show slave status</code> 结果中主库位点和备库执行的最新位点进行比较，如果值相同，表示接收到的日志已经同步完成。</p>
<p><img src="https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20220310151816.png" srcset="/img/loading.gif" lazyload alt="图2 show slave status部分结果截图"></p>
<ul>
<li>主库最新位点：Master_Log_File 和 Read_Master_Log_Pos</li>
<li>备库执行的最新位点：Relay_Master_Log_File 和 Exec_Master_Log_Pos</li>
</ul>
</li>
<li><p>对比备库上的 GTID 集合，如果 Retrieved_Gtid_Set 集合和 Executed_Gtid_Set 集合相同，则表示备库接收的所有日志已经同步完成。</p>
<ul>
<li>Auto_Position = 1 ： 表示这对主备关系使用了 GTID 协议。</li>
<li>Retrieved_Gtid_Set：备库收到的所有日志的 GTID 集合。</li>
<li>Executed_Gtid_Set：备库所有执行完成的 GTID 集合。</li>
</ul>
</li>
</ol>
<ul>
<li>方案潜在问题：在业务更新的高峰期，可能出现从库上迟迟无法响应查询请求的情况。因为业务频繁请求更新，主库位点或则 GTID 集合也会更新很快，那么上述两个位点等值判断就会一直不成立。</li>
<li>对比 sleep 方案，准确度提升了，但不够“精确”。因为是根据备库接收上接收到的日志是否执行完成判断主备延迟情况的，没有考虑主库上存在未发送到备库的binlog日志。状态如下图：</li>
</ul>
<p><img src="https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20220310155004.png" srcset="/img/loading.gif" lazyload alt="图3 主库保存了binlog但未发给从库的情况"></p>
<h4 id="semi-sync-备库位点判断"><a href="#semi-sync-备库位点判断" class="headerlink" title="semi-sync + 备库位点判断"></a>semi-sync + 备库位点判断</h4><ul>
<li><p>semi-sync 确保了所有给客户端发送过确认的事务，都确保了备库已经接收到该日志。其设计如下：</p>
<ol>
<li>事务提交时，主库将 binlog 发给备库；</li>
<li>备库收到 binlog 后，给主库发回 ack 确认；</li>
<li>主库收到 ack 之后，才给客户端返回 “事务完成” 的确认。</li>
</ol>
</li>
<li><p>通过 semi-sync + 备库位点判断的方案，<strong>只对一主一备的场景成立</strong>，在一主多从场景中，主库等到了一个从库的ack就开始向客户端返回“事务完成”的确认，如果此时客户端的查询落到没有更新的其他从库，就会产生过期读的问题。</p>
</li>
<li><p>持续延迟的情况下，可能出现过度等待的问题，状态变化如下图。</p>
<p><img src="https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20220310164311.png" srcset="/img/loading.gif" lazyload alt="图4 主备持续延迟一个事务的状态"></p>
</li>
</ul>
<h4 id="从库等主库位点方案"><a href="#从库等主库位点方案" class="headerlink" title="从库等主库位点方案"></a>从库等主库位点方案</h4><ul>
<li>查询主库位点的命令：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> master_pos_wait(file, pos[,timeout]);<br><br><span class="hljs-comment">-- 执行逻辑：</span><br><span class="hljs-comment">-- 1. 在从库执行</span><br><span class="hljs-comment">-- 2. 参数 file 和 pos 指的是主库上的文件名和位置</span><br><span class="hljs-comment">-- 3. timeout 可选，设置为正整数N：表示这个函数最多等待 N 秒</span><br><span class="hljs-comment">-- 命令返回结果</span><br><span class="hljs-comment">-- 		1. 正常结果返回一个正整数M：表示从命令开始执行，到引用为 file 和 pos 表示的binlog位置，执行了多少事务。</span><br><span class="hljs-comment">--		2. 执行期间，备库同步线程异常，返回 NULL</span><br><span class="hljs-comment">--		3. 等待超过 N 秒，返回 -1</span><br><span class="hljs-comment">--		4. 刚开始执行时，发现已经执行过这个位置，返回 0</span><br></code></pre></div></td></tr></table></figure>

<p>对于图4 状态2，先执行 trx1，在执行一个查询请求的逻辑，为了保证能够查到正确的数据，可以使用如下逻辑：</p>
<ol>
<li>trx1 事务更新完成后，马上执行 <code>show master status</code> 得到当前主库执行到的 File 和 Position；</li>
<li>选定一个从库执行查询语句；</li>
<li>在从库上执行 <code>select master_pos_wait(file, pos[,timeout]);</code> </li>
<li>如果返回值 M&gt;=0，则在这个从库上执行查询语句；否则到主库执行查询语句。</li>
</ol>
<ul>
<li><p>上述流程如下图：</p>
<p><img src="https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20220310223248.png" srcset="/img/loading.gif" lazyload alt="master_pos_wait流程"></p>
</li>
</ul>
<h4 id="从库等待主库-GTID-同步方案"><a href="#从库等待主库-GTID-同步方案" class="headerlink" title="从库等待主库 GTID 同步方案"></a>从库等待主库 GTID 同步方案</h4><ul>
<li><p>从库查询 GTID 的命令（如果数据库开启了 GTID 模式，才可以使用”从库等待主库 GTID 同步“的方案）</p>
<figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> wait_for_executed_gtid_set(gtid_set,<span class="hljs-number">1</span>);<br><br><span class="hljs-comment">-- 执行逻辑：</span><br><span class="hljs-comment">--		1. 等待，直到这个库执行的任务中包含传入的 gtid_set，返回 0</span><br><span class="hljs-comment">--		2. 超时返回 1</span><br></code></pre></div></td></tr></table></figure></li>
<li><p>在等待主库位点的方案中，执行完更新任务之后，需要主动去主库执行 show master status。从 MySQL 5.7.6 版本开始，允许在执行完更新类事务后，把这个事务的 GTID 返回给客户端。通过这种方案可以减少一次查询。</p>
</li>
<li><p>“从库等待主库 GTID 同步“ 方案 的执行流程如下：</p>
<ol>
<li>trx 1 事务更新完成之后，从返回包中直接获取这个事务的 GTID，记为 gtid1; （需要将参数 <code>session_track_gtids</code> 设置为 OWN_GTID，然后客户端通过 API 接口 <code>mysql_session_track_get_first</code> 从返回包中解析出 GTID 的值。）</li>
<li>选定一个从库执行查询语句；</li>
<li>在从库上执行 <code>select wait_for_executed_gtid_set(gtid1,1);</code></li>
<li>如果返回值是 0， 则在这个从库上执行查询语句；否则到主库执行查询语句；</li>
</ol>
</li>
<li><p>上述方案流程如下图：</p>
<p><img src="https://gitee.com/fuku-lee/blog-pic-store/raw/master/img/20220310230804.png" srcset="/img/loading.gif" lazyload alt="wait_for_executed_gtid_set流程"></p>
</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>上述 6 种方案，有些方案看上去是做了妥协，有些方案看上去不是很靠谱，当都有实际应用，需要根据业务需求进行选择。</p>
<p>即使是最后”等待位点“和”等待GTID“的两个方案，虽然可靠，但需要权衡当所有从库都延迟时，那么请求都会落在主库上，这时候主库上的压力会陡增，甚至可能导致主库崩溃。</p>
<p>实际应用中是通过几个方案混合使用的。</p>
<ol>
<li>先对客户请求做分类，区分哪些请求可以接受过期读，哪些请求完全不能接受过期读；对于不能接受过期读的语句，再使用等 GTID 或者等位点的方案。可以减轻风险。</li>
</ol>
<blockquote>
<p>举例：</p>
</blockquote>
<ul>
<li>可以接受过期读的请求可能为：商品浏览、商品发布、购物车信息浏览等查询请求。</li>
<li>不可以接受过期读的请求为：金融相关业务，付款、转账完成后的请求。</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/DataBase-MySQL-13-MySQL-%E6%95%85%E9%9A%9C%E5%88%A4%E6%96%AD/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/DataBase-MySQL-11-%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E%E7%9A%84%E7%BB%93%E6%9E%84%E4%BB%A5%E5%8F%8A%E5%88%87%E6%8D%A2%E6%B5%81%E7%A8%8B/">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>














  
<script src="/js/diy/caidai.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
